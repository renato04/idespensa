<!DOCTYPE html>
<html ng-app="ionicApp">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">

  <title>Ionic-AngularJS-Cordova</title>

  <!-- Ionic framework - replace the CDN links with local files and build -->    
  <link href="css/ionic.css" rel="stylesheet">
  <script src="js/constant.js"></script>
  <script src="js/ionic.bundle.js"></script>
  <script src="js/guid.js"></script>
  <script src="js/underscore.js"></script>
  <script src="js/indexeddb.js"></script>
  <script src="js/moment.js"></script>
  <script src="js/config.js"></script>
  <script src="js/controllers.js"></script>
  <script src="js/app.js"></script>
    

  <style>
      .box {height:300px;padding: 10px}
  </style>      
</head>

<body ng-controller="AppCtrl">

<ion-side-menus>
  <!-- Center content -->
  <ion-side-menu-content>

    <ion-nav-bar class="nav-title-slide-ios7 bar-positive">
      <ion-nav-back-button class="button-icon ion-arrow-left-c">
      </ion-nav-back-button>
    </ion-nav-bar>
      <ion-nav-buttons side="left">
        <button class="button button-icon button-clear ion-navicon" ng-click="toggleLeft()">
        </button>
      </ion-nav-buttons>    
             
    <ion-nav-view animation="slide-left-right" name="main-view"></ion-nav-view>

  </ion-side-menu-content>

  <!-- Left menu -->
  <ion-side-menu side="left">
      <ion-header-bar class="bar-positive">
        <h1 class="title">Menu</h1>
      </ion-header-bar>
      <ion-content>
        <div class="list">

          <a menu-close href="#" class="item item-icon-left">
            <i class="icon ion-home"></i>
            Home
          </a>

          <a menu-close href="#/produto" class="item item-icon-left">
            <i class="icon ion-home"></i>
            Produtos
          </a>

          <a menu-close href="#/categoria" class="item item-icon-left">
            <i class="icon ion-home"></i>
            Categorias
          </a>        

        </div>  
    </ion-content>
  </ion-side-menu>
</ion-side-menus>


  <script id="home.html" type="text/ng-template">
 
   <ion-view title="Home">
      <ion-content>
        <div class="card">
          <div class="item item-divider">
            Produtos
          </div>
          <div class="item item-body">
            <ion-scroll>
              <div class="list" style="height: 250px;">
                <div class="item" ng-repeat="produto in produtos | filter:{nome: filtroProduto}">
                  <p> {{produto.nome}} Quantidade: {{produto.quantidade}} </p>
                  <div class="button-bar">
                    <button class="button button-small button-positive" ng-click="add(produto)">adiciona</button>
                    <button class="button button-small button-positive" ng-click="remove(produto)">retira</button>
                  </div>                  
                </div>
              </div>
            </ion-scroll>
            <div class="item item-divider">
                <label class="item item-input">
                  <i class="icon ion-search placeholder-icon"></i>
                  <input type="text" placeholder="buscar" ng-model="filtroProduto">
                </label>
            </div>          
          </div>
        <div class="card">
          <div class="item item-divider">
            Lista de Compras
          </div>
          <div class="item item-body">
            <ion-scroll>
              <div class="list" style="height: 250px;">
                <div class="item" ng-show="ListaVazia()">
                    <p> Não há item na sua lista de compras</p>
                </div>
                <div class="item" ng-repeat="produto in produtos | filter:entraNaLista">
                  <p> {{produto.nome}} Quantidade: {{produto.quantidade}} </p>
                  <div class="button-bar">
                    <button class="button button-small button-positive" ng-click="add(produto)">adiciona</button>
                    <button class="button button-small button-positive" ng-click="remove(produto)">retira</button>
                  </div>                  
                </div>
              </div>
            </ion-scroll>
          </div>
        </div> 

        <div class="card">
          <div class="item item-divider">
            Perto do Vencimento
          </div>
          <div class="item item-body">
            <ion-scroll>
              <div class="list" style="height: 250px;">
                <div class="item" ng-show="SemItemsVencendo()">
                    <p> Não há produtos próximos ao vencimento</p>
                </div>
                <div class="item" ng-repeat="produto in produtos | filter:estaVencendo">
                  <p> {{produto.nome}}</p>
                </div>
              </div>
            </ion-scroll>
          </div>
        </div>  
      </ion-content>
     </ion-view>
  </script>


<script id="produto.html" type="text/ng-template">

   <ion-view title="Produtos">
      <ion-content>
        <div class="list">
          <a class="item" href="#/produto-cadastro?id={{item.id}}" ng-repeat="item in items | filter:{nome: modal.searchText}">
            {{item.nome}}
            <span class="item-note">
              {{item.quantidade}}
            </span>
          </a>
        </div>    
      </ion-content>
      <div class="tabs tabs-icon-top">
        <a class="tab-item" href="#/produto-cadastro">
          <i class="icon ion-home"></i>
          adicionar
        </a>
        <a class="tab-item" ng-click="openModal()">
          <i class="icon ion-search"></i>
          filtrar
        </a>
      </div>     
    </ion-view>
 
  </div>
</script>   

<script id="busca.html" type="text/ng-template">
  <div class="bar bar-header item-input-inset">
    <label class="item-input-wrapper">
      <i class="icon ion-ios7-search placeholder-icon"></i>
      <input type="search" placeholder="busca" ng-model="modal.searchText">
    </label>
    <button class="button button-clear" ng-click="closeModal()">
      cancelar
    </button>
  </div>
</script>
    
<script id="produto-cadastro.html" type="text/ng-template">

   <ion-view title="Adicionar">
      <form name="formProduto">
        <ion-content >
          <div class="card">
            <div class="item item-divider">
              Produto
            </div>
            <div class="item item-body">
              <div class="list">
                <label class="item item-input item-stacked-label">
                  <span class="input-label">Nome</span>
                  <input type="text" placeholder="Nome do produto. Ex Arroz 5kg"  ng-model="produto.nome" ng-minlength="3"  required>
                </label>
                <label class="item item-input item-stacked-label">
                  <span class="input-label">Quantidade</span>
                  <input type="number" min="0" placeholder="quantidade" ng-model="produto.quantidade" required>
                </label>            
                <label class="item item-input item-select">
                  <div class="input-label">
                    categoria
                  </div>
                  <select ng-model="produto.categoria" ng-options="categoria.id as categoria.nome for categoria in categorias"></select>
                </label>  
                <label class="item item-input item-stacked-label">
                  <span class="input-label">Data de validade</span>
                  <input type="date" ng-model="produto.data_validade" required>
                </label>
                <label class="item item-input">
                  <div class="input-label">
                    Lista de Compras
                  </div>                
                  <label class="toggle">
                     <input type="checkbox" ng-model="produto.lista_automatico">
                     <div class="track">
                       <div class="handle"></div>
                     </div>
                  </label>
                </label>
                <label class="item item-input item-stacked-label" ng-show="produto.lista_automatico">
                  <span class="input-label">Quantidade</span>
                  <input type="number" min="0" placeholder="quantidade p/ entrar na lista" ng-model="produto.quantidade_lista">
                </label>                  
              </div>
            </div>
          </div>
        </ion-content>
        <div class="bar bar-footer bar-positive">
            <button class="button button-balanced" ng-click="save(produto)" ng-disabled="formProduto.$invalid">salvar</button>
        </div> 

      </form>
    </ion-view>
 
</script>    

<script id="categoria.html" type="text/ng-template">

   <ion-view title="Categorias">
      <ion-content>
        <div class="list">
          <a class="item" href="#/categoria-cadastro?id={{item.id}}" ng-repeat="item in items | filter:{nome: modal.searchText}" >
            {{item.nome}}
          </a>
        </div>    
      </ion-content>
      <div class="tabs tabs-icon-top">
        <a class="tab-item" href="#/categoria-cadastro">
          <i class="icon ion-home"></i>
          adicionar
        </a>
        <a class="tab-item" ng-click="openModal()">
          <i class="icon ion-search"></i>
          filtrar
        </a>
      </div>     
    </ion-view>
 
</script>   

<script id="categoria-cadastro.html" type="text/ng-template">

   <ion-view title="Adicionar">
      <form name="form">
        <ion-content >
          <div class="card">
            <div class="item item-divider">
              Categoria
            </div>
            <div class="item item-body">
              <div class="list">
                <label class="item item-input item-stacked-label">
                  <span class="input-label">Nome</span>
                    <input type="text" placeholder="Nome do produto. Ex Besteira"  ng-model="categoria.nome" ng-minlength="3"  required>
                </label>
              </div>
            </div>
          </div>   
        </ion-content>
        <div class="bar bar-footer bar-positive">
            <button class="button button-balanced" ng-click="save(categoria)" ng-disabled="form.$invalid">salvar</button>
        </div>         
      </form>
    </ion-view>
 
</script> 
</body>
</html>
